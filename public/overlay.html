<!doctype html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <title>Now Playing Overlay</title>
    <style>
      html,
      body {
        margin: 0;
        padding: 0;
        background: transparent;
        overflow: hidden;
        font-family: "Pretendard", system-ui, sans-serif;
      }

      .overlay-wrap {
        padding: 6px 12px;
        border-radius: 999px;
        background: rgba(0, 0, 0, 0.6);
        border: 1px solid rgba(255, 255, 255, 0.15);
        display: inline-flex;
        align-items: center;
        gap: 10px;
        box-shadow:
          0 0 12px rgba(0, 0, 0, 0.9),
          0 0 18px rgba(255, 46, 99, 0.28);
      }

      .label {
        font-size: 11px;
        text-transform: uppercase;
        letter-spacing: 0.16em;
        opacity: 0.7;
      }

      .now,
      .next {
        display: flex;
        flex-direction: column;
      }

      .now-title {
        font-size: 15px;
        font-weight: 700;
        text-shadow: 0 0 3px rgba(0, 0, 0, 0.9);
      }

      .now-artist {
        font-size: 12px;
        opacity: 0.85;
        text-shadow: 0 0 3px rgba(0, 0, 0, 0.9);
      }

      .next-title {
        font-size: 12px;
        opacity: 0.8;
        text-shadow: 0 0 3px rgba(0, 0, 0, 0.9);
      }

      .divider {
        width: 1px;
        height: 24px;
        background: rgba(255, 255, 255, 0.2);
      }
    </style>
  </head>
  <body>
    <div class="overlay-wrap">
      <div class="label">NOW</div>
      <div class="now">
        <div class="now-title" id="nowTitle">-</div>
        <div class="now-artist" id="nowArtist"></div>
      </div>
      <div class="divider"></div>
      <div class="label">NEXT</div>
      <div class="next">
        <div class="next-title" id="nextTitle">-</div>
      </div>
    </div>

    <script>
      async function fetchQueue() {
        try {
          const res = await fetch("/api/queue");
          if (!res.ok) return;
          const data = await res.json();

          const current = data.current;
          const next = data.next;

          document.getElementById("nowTitle").textContent = current
            ? current.title
            : "-";
          document.getElementById("nowArtist").textContent = current
            ? current.artist +
              (current.memo ? " (" + current.memo + ")" : "")
            : "";

          document.getElementById("nextTitle").textContent = next
            ? `${next.title} - ${next.artist}`
            : "-";
        } catch (e) {
          console.error(e);
        }
      }

      fetchQueue();
      setInterval(fetchQueue, 3000); // 3초마다 갱신
    </script>
  </body>
</html>
